!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["skyline-component-image-capture"]=t():e["skyline-component-image-capture"]=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.i18n={modal_title:"Upload New Image",modal_close:"Close",modal_description:"Here you can choose and upload images to your application",modal_cancel:"Cancel",modal_accept:"Upload",modal_drop_zone_text:"Or drop file here…",source_local_file:"Disk",source_remote_file:"URL",source_remote_file_load:"Load…",source_camera:"Camera",source_camera_error:"Could not init or load from camera.",source_camera_capture:"Capture",source_camera_default_name:"captured.jpg",quality_title:"Quality",quality_perfect:"Perfect",quality_OK:"OK",quality_sufficient:"Sufficient",quality_scarce:"Scarce",quality_insufficient:"insufficient",ratio_title:"Aspect Ratio",ratio_bad:"Bad ratio (required 16:9 until 1:1)",dimension_title:"Dimension",size_title:"Size",property_slug_error:"Slug must only contain latin characters",image_load_error:"Could not load the image.",property_slug_label:"Slug",property_slug_placeholder:"my-file",property_caption_label:"Caption",property_caption_placeholder:"My Image",property_alt_label:"Alt",property_alt_placeholder:"Text in error case",options_label:"Options",option_scale_to_best:"Scale to optimal size",option_render_preview:"Render preview",option_make_watermark:"Render Watermark",option_make_main:"Make main image"}},function(e,t,n){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),!window.jQuery)throw new Error("The skyline component 'image-capture' requires jquery.");t.default=window.jQuery},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileChecker=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=(r=i)&&r.__esModule?r:{default:r},u=n(4);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.FileChecker=function(e){function t(){return s(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"renderTemplate",value:function(){var e=(0,a.default)(this.template);return this.bindTemplate(e),e}},{key:"bindTemplate",value:function(e){}},{key:"reset",value:function(){}},{key:"checkImage",value:function(e,t){}},{key:"template",get:function(){return""}}]),t}(u.Renderable)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Source=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=n(1),u=(r=a)&&r.__esModule?r:{default:r};t.Source=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handlers=[],e.selectByDefault=!0,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"renderTemplate",value:function(){var e=(0,u.default)(this.template);return this.bindTemplate(e),e}},{key:"select",value:function(){}},{key:"deselect",value:function(){}},{key:"bindTemplate",value:function(e){}},{key:"reset",value:function(){}},{key:"handler",value:function(e){"function"==typeof e&&this.handlers.push(e)}},{key:"handle",value:function(e){this.handlers.forEach((function(t){return t(e)}))}},{key:"template",get:function(){return""}},{key:"name",get:function(){return""}}]),t}(i.Renderable)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Renderable=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"renderTemplate",value:function(){}},{key:"reset",value:function(){}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Property=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(1)),i=n(11),a=n(4),u=s(n(8));function s(e){return e&&e.__esModule?e:{default:e}}t.Property=function(e){function t(e){var n=e.name,r=e.label,a=void 0===r?null:r,s=e.icon,c=void 0===s?null:s,l=e.placeholder,f=void 0===l?"":l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return p.id=u.default.guid(),p.name=n,p.renderTemplate=function(){var e=(0,o.default)("function"==typeof i._property?(0,i._property)({id:p.id,label:a,icon:c}):i._property),t=(0,o.default)("function"==typeof p.template?p.template({id:p.id,placeholder:f}):p.template);return p.bindTemplate(e,t),e},p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"template",get:function(){return function(e){e.id,e.placeholder;return""}}}]),r(t,[{key:"renderTemplate",value:function(){}},{key:"bindTemplate",value:function(e,t){e.find(".input-group").append(t),this.bound=e,this.boundI=t}},{key:"validate",value:function(e,t){return!0}},{key:"willAppear",value:function(e,t){}},{key:"value",get:function(){return this.boundI.val()}}]),t}(a.Renderable)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Frame=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(1),a=(r=i)&&r.__esModule?r:{default:r};t.Frame=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"renderTemplate",value:function(){var e=(0,a.default)(this.template);return this.bindTemplate(e),e}},{key:"bindTemplate",value:function(e){this.boundImage=e.find("img")}},{key:"reset",value:function(){}},{key:"loadImage",value:function(e){e.file;var t=e.image,n=e.complete,r=e.error;this.boundImage[0].onload=n,this.boundImage[0].onerror=r,this.boundImage[0].src=t.src}},{key:"saveProperties",value:function(e){}},{key:"template",get:function(){return""}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaskDefault=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(9);t.MaskDefault=function(e){function t(e){var n=e.size,r=void 0===n?300:n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return o.size=r,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"frameDimensions",get:function(){return[this.size,this.size]}},{key:"imageDimensions",get:function(){return this.frameDimensions}}]),t}(o.Mask)},function(e,t,n){"use strict";if(Object.defineProperty(t,"__esModule",{value:!0}),!window.Skyline)throw new Error("The skyline component 'image-capture' requires component Skyline.");t.default=window.Skyline},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Mask=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"saveProperties",value:function(e){e.mask={size:this.imageDimensions}}},{key:"frameDimensions",get:function(){return[0,0]}},{key:"imageDimensions",get:function(){return[0,0]}},{key:"maskSVG",get:function(){return""}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._limits=void 0;var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(17),u=n(11),s=n(2),c=n(5),l=n(1),f=(r=l)&&r.__esModule?r:{default:r},p=n(18),d=n(0),h=n(12),y=n(19),v=n(20),b=n(3),m=n(6),_=n(13);var g=t._limits={FILE_SIZE:2e6,UPLOADS:20,POST_SIZE:8e6},w={panel:a._panel,property:u._property,option:h._option},k=function(e){function t(e){var n=e.checkers,r=void 0===n?null:n,o=e.properties,i=void 0===o?null:o,a=e.options,u=void 0===a?null:a,s=e.sources,c=void 0===s?null:s,l=e.frame,f=void 0===l?null:l;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var p=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,new v.Events));return p.checkers=[],p.properties=new Map,p.options=new Map,p.sources=new Map,p.setupFrame(f),r&&r.forEach((function(e){return p.addChecker(e)})),i&&i.forEach((function(e){return p.addProperty(e)})),u&&u.forEach((function(e){return p.addOption(e)})),c&&c.forEach((function(e){return p.addSource(e)})),p}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"LIMITS",get:function(){return g}},{key:"TEMPLATES",get:function(){return w}},{key:"TRANSLATIONS",get:function(){return d.i18n}}]),i(t,[{key:"addSource",value:function(e){var t=this;return e instanceof b.Source&&(this.sources.set(e.name,e),e.handler((function(n){t.sources.has(e.name)&&t.updateFromInput(n)})),this.view.addSource(e),e.selectByDefault&&this.selectSource(e)),this}},{key:"removeSource",value:function(e){e instanceof b.Source&&(e=e.name);var t=this.sources.get(e);return t&&this.view.removeSource(t),this.sources.delete(e),this}},{key:"clearSources",value:function(){var e=this;this.sources.forEach((function(t){return e-e.removeSource(t)}))}},{key:"selectSource",value:function(e){e instanceof b.Source&&(e.select(),this.view.select(e))}},{key:"setupFrame",value:function(e){e instanceof m.Frame?(this.frame=e,this.view.setupFrame(e)):this.setupFrame(new _.DisplayOnlyFrame)}},{key:"addChecker",value:function(e){return e instanceof s.FileChecker&&(this.checkers.push(e),this.view.addChecker(e)),this}},{key:"removeChecker",value:function(e){var t=this.checkers.indexOf(e);return!1!==t&&(delete this.checkers[t],this.view.removeChecker(e)),this}},{key:"clearCheckers",value:function(){var e=this;this.checkers.forEach((function(t){return e-e.removeChecker(t)}))}},{key:"addProperty",value:function(e){return e instanceof c.Property&&(this.properties.set(e.name,e),this.view.addProperty(e)),this}},{key:"removeProperty",value:function(e){e instanceof c.Property&&(e=e.name);var t=this.properties.get(e);return t&&this.view.removeProperty(t),this.properties.delete(e),this}},{key:"clearProperties",value:function(){var e=this;this.properties.forEach((function(t){return e-e.removeProperty(t)}))}},{key:"addOption",value:function(e){return"number"==typeof e.id&&(this.options.set(e.id,e),this.view.addOption(e)),this}},{key:"removeOption",value:function(e){"object"===(void 0===e?"undefined":o(e))&&(e=e.id);var t=this.options.get(e);return t&&this.view.removeOption(t),this.options.delete(e),this}},{key:"clearOptions",value:function(){var e=this;this.options.forEach((function(t){return e-e.removeOption(t)}))}},{key:"run",value:function(e){this.checkers.forEach((function(e){return e.reset()})),this.properties.forEach((function(e){return e.reset()})),this.sources.forEach((function(e){return e.reset()})),this.frame.reset(),this.view.propertyEl.find(".alert").remove(),this.view.runModal()}},{key:"updateFromInput",value:function(e){var t=this;if(!e)throw new Error("image capture did not receive any file.");if(/^image\/.+/.test(e.type)){var n=new FileReader;n.onload=function(){t.file=e;var r=new Image;t.image=r,r.src=n.result,t.frame.loadImage({file:e,image:r,complete:function(){t.view.fileInfo.show(),t.view.sourcesElM.hide(),t.view.selectedSource.deselect();var n=!0;t.checkers.forEach((function(t){n=t.checkImage(r,e)&&n})),t.properties.forEach((function(t){return t.willAppear(r,e)})),t.options.forEach((function(n){"function"==typeof n.willAppear&&n.willAppear(r,e,t.view.options.get(n).find("input")[0])})),n&&t.view.saveButton.attr("disabled",!1),t.trigger("update",{file:e,image:r})},error:function(){t.view.presentError(d.i18n.image_load_error,"error"),t.trigger("error")}})},n.readAsDataURL(e)}}},{key:"validateAndSave",value:function(){var e=this;this.view.propertyEl.find(".alert").remove();try{this.properties.forEach((function(t){t.validate(e.image,e.file)}));var t={};this.properties.forEach((function(e){return t[e.name]=e.value}));var n=0;this.options.forEach((function(e){n|=e.value})),this.view.progressEl.show();var r=function(t){t=Math.round(100*t),e.view.progressEl.find(".progress-bar").css("width",t+"%").attr("aria-valuenow",t).text(t+"%")};r(0),this.frame.saveProperties(t),this.trigger("save",{file:this.file,image:this.image,options:n,properties:t,progress:r,done:function(){e.view._skip_c=!0,e.cancel(),e.view._skip_c=!1},error:function(t){e.view.progressEl.hide(),e.view.propertyEl.prepend("<div class='alert alert-danger'>"+t+"</div>")}})}catch(e){this.view.propertyEl.prepend("<div class='alert alert-danger'>"+e.message+"</div>")}}},{key:"cancel",value:function(){this.view.el.modal("hide")}},{key:"view",get:function(){if(!this._view){var e=(0,f.default)(w.panel());(0,f.default)(document.body).append(e),this._view=new p.ImageCaptureView(this,e)}return this._view}}]),t}(y.Emitter);t.default=new k({})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t._property=function(e){return'<div class="form-group row">\n                            <label for="'+e.id+'" class="col-lg-2 col-form-label">'+e.label+'</label>\n                            <div class="col-lg-10">\n                                <div class="input-group">\n                                    <div class="input-group-prepend">\n                                        <span class="input-group-text"><i class="fa '+e.icon+'"></i></span>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n'}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t._option=function(e,t,n){return"<div><input id='option-"+e+'\' class="sky-checkbox" type="checkbox" value="'+t+'"> <label for="option-'+e+'">'+n+"</label></div>"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisplayOnlyFrame=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(6);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.DisplayOnlyFrame=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"template",get:function(){return'<figure class="figure w-100 text-center">\n                            <img class="w-75 img-fluid rounded shadow" src="" alt="">\n                        </figure>'}}]),t}(o.Frame)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextFieldProperty=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(5);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.TextFieldProperty=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"template",get:function(){return function(e){var t=e.id;return'<input type="text" class="form-control" placeholder="'+e.placeholder+'" id="'+t+'" value="">'}}}]),t}(o.Property)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mask16_9=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7);t.Mask16_9=function(e){function t(e){var n=e.width,r=void 0===n?1024:n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{size:r}));return o.q=9/16,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"imageDimensions",get:function(){return[this.size,this.size*this.q]}},{key:"maskSVG",get:function(){var e=[this.size,Math.abs(this.size-this.size*this.q)/2],t=e[0],n=e[1];return"M0,0 l"+t+",0 l0,"+n+" l-"+t+",0 M 0,"+t+" l"+t+",0 0,-"+n+" -"+t+",0z"}}]),t}(o.MaskDefault)},function(e,t,n){"use strict";var r,o,i=n(10),a=(r=i)&&r.__esModule?r:{default:r},u=n(2),s=n(21),c=n(22),l=n(23),f=n(24),p=n(5),d=n(25),h=n(14),y=n(26),v=n(27),b=n(3),m=n(28),_=n(29),g=n(30),w=n(6),k=n(13),O=n(31),j=n(9),P=n(7),E=n(33),S=n(15),T=n(34);o=window.Skyline,Object.assign(o,{ImageCapture:a.default,Source:{Source:b.Source,LocalFileSource:m.LocalFileSource,RemoteFileSource:_.RemoteFileSource,CameraSource:g.CameraSource},Frame:{Frame:w.Frame,DisplayOnlyFrame:k.DisplayOnlyFrame,EditorFrame:O.EditorFrame},Mask:{Mask:j.Mask,MaskDefault:P.MaskDefault,MaskCircle:E.MaskCircle,Mask16_9:S.Mask16_9,Mask4_3:T.Mask4_3},Checker:{FileChecker:u.FileChecker,QualityChecker:s.QualityChecker,RatioChecker:c.RatioChecker,DimensionChecker:l.DimensionChecker,FileSizeChecker:f.FileSizeChecker},Property:{Property:p.Property,TextFieldProperty:h.TextFieldProperty,TextAreaProperty:y.TextAreaProperty,SlugTextFieldProperty:d.SlugTextFieldProperty},Option:{Option:v.Option,DisabledOption:v.DisabledOption}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t._panel=void 0;var r=n(0);t._panel=function(){return'<div class="modal fade" id="sky-it-capture-modal" tabindex="-1" role="dialog" aria-labelledby="sky-it-capture-modal-titel"\n     aria-hidden="true">\n    <div class="modal-dialog" role="document">\n        <div class="modal-content">\n            <div class="modal-header alert-primary">\n                <h5 class="modal-title" id="sky-it-capture-modal-titel">'+r.i18n.modal_title+'</h5>\n                <button type="button" class="close" data-dismiss="modal" aria-label="'+r.i18n.modal_close+'">\n                    <span aria-hidden="true">&times;</span>\n                </button>\n            </div>\n            <div class="modal-body">\n                    <p>\n'+r.i18n.modal_description+'                    </p>\n                    <div class=\'sources\'><ul class=\'nav nav-tabs\' role=\'tablist\'></ul>\n<div class="tab-content">\n</div></div>                           <div class="file-info"><div class=\'frame-set\'></div>\n                        <ul class="list-group">\n                        </ul>\n\n                        <hr class="my-2">\n                        <div class=\'property-container\'></div>                            <div class="form-group row">\n                            <label for="" class="col-lg-2 col-form-label options-label d-none">'+r.i18n.options_label+'</label>\n                            <div class="col-md-9 pt-1">\n                                <div class="option-container"></div>\n                            </div>\n                        </div>\n                        <div class="progress">\n                            <div class="progress-bar" role="progressbar" style="width: 25%;" aria-valuenow="25"\n                                 aria-valuemin="0" aria-valuemax="100">25%\n                            </div>\n                        </div>\n            </div>\n        </div>\n        <div class="modal-footer d-flex justify-content-between">\n            <button type="button" class="btn btn-sm btn-outline-danger" data-dismiss="modal">'+r.i18n.modal_cancel+'</button>\n            <button type="button" class="btn btn-sm btn-outline-success" data-role="update">'+r.i18n.modal_accept+"</button>\n        </div>\n    </div>\n</div>"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.ImageCaptureView=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.el=n,this._skip_c=!1,this._emitter=t,n.on("hide.bs.modal",(function(){r._skip_c||(t.sources.forEach((function(e){return e.deselect()})),t.trigger("cancel"))})),this.checkerEl=n.find(".list-group"),this.frameEl=n.find(".frame-set"),this.propertyEl=n.find(".property-container"),this.optionEl=n.find(".option-container"),this.optionLbl=n.find(".options-label"),this.sourcesElM=n.find(".sources"),this.sourcesEl=n.find(".sources .tab-content"),this.sourcesTabEl=n.find(".sources .nav"),this.fileInfo=n.find(".file-info"),this.imageEl=this.fileInfo.find("img")[0],this.progressEl=n.find(".progress"),this.saveButton=n.find("button[data-role='update']"),this.checkers=new Map,this.properties=new Map,this.options=new Map,this.sources=new Map,this.selectedSource=null,this.frame=null,this.saveButton.on("click",(function(e){return t.validateAndSave()}))}return r(e,[{key:"runModal",value:function(){this.sourcesElM.show(),this.fileInfo.hide(),this.progressEl.hide(),this.fileInfo.find("alert").remove(),this.saveButton.attr("disabled","disabled"),this.el.modal("show")}},{key:"presentError",value:function(e,t){this.fileInfo.prepend("<div class='alert alert-"+t+"'>"+e+"</div>")}},{key:"addSource",value:function(e){var t=this;if(!this.sources.has(e)){var n=e.renderTemplate(),r=$('<div class="tab-pane fade" role="tabpanel"></div>');r.append(n),this.sourcesEl.append(r);var o=$("<li class='nav-item' role='presentation'><a class=\"nav-link\" href='#' onclick='return false;'>"+e.name+"</a></li>");o.on("click",(function(){t._emitter.selectSource(e)})),this.sources.set(e,{w:r,t:o}),this.sourcesTabEl.append(o)}}},{key:"select",value:function(e){if(e&&this.selectedSource!==e){this.selectedSource&&this.selectedSource.deselect(),this.selectedSource=e;var t=this.sources.get(e);if(t){var n=t.w,r=t.t;this.sourcesTabEl.find("li a").removeClass("active"),r.find("a").addClass("active"),this.sourcesEl.find(".tab-pane").removeClass("show").removeClass("active"),n.addClass("active").addClass("show")}}}},{key:"removeSource",value:function(e){if(this.sources.has(e)){var t=this.sources.get(e),n=t.w,r=t.t;this.selectedSource===e&&(e.deselect(),this.selectedSource=null,this.sourcesTabEl.find("li a").removeClass("active"),this.sourcesEl.find(".tab-pane").removeClass("show").removeClass("active")),n.remove(),r.remove(),this.sources.delete(e)}}},{key:"setupFrame",value:function(e){this.frame&&this.frame.remove(),this.frame=e.renderTemplate(),this.frameEl.append(this.frame)}},{key:"addChecker",value:function(e){if(!this.checkers.has(e)){var t=e.renderTemplate();this.checkerEl.append(t),this.checkers.set(e,t)}}},{key:"removeChecker",value:function(e){this.checkers.has(e)&&(this.checkers.get(e).remove(),this.checkers.delete(e))}},{key:"addProperty",value:function(e){if(!this.properties.has(e)){var t=e.renderTemplate();this.propertyEl.append(t),this.properties.set(e,t)}}},{key:"removeProperty",value:function(e){this.properties.has(e)&&(this.properties.get(e).remove(),this.properties.delete(e))}},{key:"addOption",value:function(e){if(!this.options.has(e)){var t=e.renderTemplate();this.optionEl.append(t),this.options.set(e,t),this.optionLbl.removeClass("d-none")}}},{key:"removeOption",value:function(e){this.options.has(e)&&(this.options.get(e).remove(),this.options.delete(e),this.options.size<1&&this.optionLbl.addClass("d-none"))}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.Emitter=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.events=t instanceof e?t.events:t.handlers}return r(e,[{key:"on",value:function(e,t){var n=this;return("string"==typeof e?e.split(" "):e).forEach((function(e){if(!n.events[e])throw new Error("The event "+e+" does not exist");n.events[e].push(t)})),this}},{key:"trigger",value:function(e,t){if(!(e in this.events))throw new Error("The event "+e+" cannot be triggered");var n=!0,r=this;return this.events[e].forEach((function(e){"function"==typeof e&&(n=e.call(r,t)&&n)})),n}},{key:"bind",value:function(e){if(this.events[e])throw new Error("The event "+e+" is already bound");this.events[e]=[]}},{key:"exists",value:function(e){return Array.isArray(this.events[e])}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Events=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handlers={update:[],error:[console.error],save:[],cancel:[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QualityChecker=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=n(0);t.QualityChecker=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return"function"==typeof e.sort&&e.sort((function(e,t){return e.q<t.q?-1:e.q>t.q?1:0})),n.breakpoints=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"template",get:function(){return'<li class="list-group-item d-flex justify-content-between p-1">\n                                <strong>'+i.i18n.quality_title+"</strong>\n                                <span></span>\n                            </li>\n"}}],[{key:"IMAGE_BREAKPOINTS",get:function(){return[{q:767,l:i.i18n.quality_scarce,c:"warning",ok:!0},{q:1023,l:i.i18n.quality_sufficient,c:"warning",ok:!0},{q:1439,l:i.i18n.quality_OK,c:"success",ok:!0},{q:1919,l:i.i18n.quality_perfect,c:"success",ok:!0}]}},{key:"ICON_BREAKPOINTS",get:function(){return[{q:99,l:i.i18n.quality_scarce,c:"warning",ok:!0},{q:256,l:i.i18n.quality_sufficient,c:"warning",ok:!0},{q:511,l:i.i18n.quality_OK,c:"success",ok:!0},{q:1023,l:i.i18n.quality_perfect,c:"success",ok:!0}]}}]),r(t,[{key:"bindTemplate",value:function(e){this.boundClass=e,this.boundQ=e.find("span")}},{key:"reset",value:function(){this.boundClass.removeClass("list-group-item-success").removeClass("list-group-item-warning").removeClass("list-group-item-danger"),this.boundQ.html("")}},{key:"checkImage",value:function(e,t){var n=Math.max(e.width,e.height),r="danger",o=i.i18n.quality_insufficient,a=!1;return this.breakpoints.forEach((function(e){n>e.q&&(r=e.c,o=e.l,a=e.ok)})),""!==r&&this.boundClass.addClass("list-group-item-"+r),this.boundQ.html(o),a}}]),t}(o.FileChecker)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RatioChecker=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=n(0);t.RatioChecker=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.ratio=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"bindTemplate",value:function(e){this.bound=e}},{key:"reset",value:function(){this.bound.addClass("d-none").removeClass("d-flex")}},{key:"checkImage",value:function(e,t){var n=e.width/e.height;return n<this.ratio&&n>1/this.ratio?(this.bound.addClass("d-none").removeClass("d-flex"),!0):(this.bound.removeClass("d-none").addClass("d-flex"),!1)}},{key:"template",get:function(){return'<li class="list-group-item d-flex justify-content-between p-1 list-group-item-danger">\n                                <strong>'+i.i18n.ratio_title+"</strong>\n                                <span>"+i.i18n.ratio_bad+"</span>\n                            </li>\n"}}]),t}(o.FileChecker)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DimensionChecker=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(2),i=n(0);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.DimensionChecker=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"bindTemplate",value:function(e){this.bound=e.find("span")}},{key:"reset",value:function(){this.bound.html("")}},{key:"checkImage",value:function(e,t){return this.bound.html(e.width+"x"+e.height),!0}},{key:"template",get:function(){return'<li class="list-group-item d-flex justify-content-between p-1">\n                                <strong>'+i.i18n.dimension_title+"</strong>\n                                <span></span>\n                            </li>\n"}}]),t}(o.FileChecker)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FileSizeChecker=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(2),a=n(0),u=n(10),s=n(8),c=(r=s)&&r.__esModule?r:{default:r};function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.FileSizeChecker=function(e){function t(){return l(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"bindTemplate",value:function(e){this.bound=e,this.boundQ=e.find("span")}},{key:"reset",value:function(){this.bound.removeClass("list-group-item-danger"),this.boundQ.html("-.-")}},{key:"checkImage",value:function(e,t){return this.boundQ.html(c.default.Byte.format(t.size)),!(t.size>u._limits.FILE_SIZE||t.size>u._limits.POST_SIZE)||(this.bound.addClass("list-group-item-danger"),!1)}},{key:"template",get:function(){return'<li class="list-group-item d-flex justify-content-between p-1">\n                                <strong>'+a.i18n.size_title+"</strong>\n                                <span></span>\n                            </li>\n"}}]),t}(i.FileChecker)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SlugTextFieldProperty=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},a=n(14),u=n(1),s=(r=u)&&r.__esModule?r:{default:r},c=n(0);function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.SlugTextFieldProperty=function(e){function t(){return l(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"bindTemplate",value:function(e,n){i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bindTemplate",this).call(this,e,n);var r=(0,s.default)('<div class="input-group-append"><span class="input-group-text"></span></div>');this.boundE=r.find("span"),e.find(".input-group").append(r)}},{key:"validate",value:function(e,t){if(/^[a-zA-Z0-9_.\-]+$/.test(this.value))return!0;throw new Error(c.i18n.property_slug_error)}},{key:"willAppear",value:function(e,t){var n=t.name.replace(/[^a-zA-Z0-9_.]/g,"-");n=n.split("."),this.extension=n.pop().toLowerCase(),this.boundE.text("."+this.extension),this.boundI.val(n.join("."))}},{key:"value",get:function(){var e=i(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"value",this);return"."+e.split(".").pop()===this.boundE.text()?e:e+this.boundE.text()}}]),t}(a.TextFieldProperty)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaProperty=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(5);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.TextAreaProperty=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"template",get:function(){return function(e){var t=e.id;return'<textarea class="form-control" rows="3" placeholder="'+e.placeholder+'" id="'+t+'"></textarea>'}}}]),t}(o.Property)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DisabledOption=t.Option=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(4),a=n(12),u=n(1),s=(r=u)&&r.__esModule?r:{default:r};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function f(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var p=t.Option=function(e){function t(e){var n=e.id,r=e.label,o=e.checkedByDefault,i=void 0!==o&&o;c(this,t);var u=l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return u.id=n,u.label=r,u.checked=i,u.renderTemplate=function(){var e=(0,s.default)("function"==typeof a._option?(0,a._option)(u.id,u.id,r):a._option);return u.bindTemplate(e),e},u}return f(t,e),o(t,[{key:"reset",value:function(){this.boundI[0].checked=this.checked}},{key:"bindTemplate",value:function(e){this.bound=e,this.boundI=e.find("input")}},{key:"willAppear",value:function(e,t,n){n.checked=this.checked}},{key:"value",get:function(){return this.boundI[0].checked?1*this.boundI[0].value:0}}]),t}(i.Renderable);t.DisabledOption=function(e){function t(e){var n=e.id,r=e.label,o=e.checkedByDefault,i=void 0!==o&&o;return c(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{id:n,label:r,checkedByDefault:i}))}return f(t,e),o(t,[{key:"bindTemplate",value:function(e){(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bindTemplate",this).call(this,e),this.disable()}},{key:"enable",value:function(){this.bound.removeClass("text-muted"),this.boundI.attr("disabled",!1)}},{key:"disable",value:function(){this.bound.addClass("text-muted"),this.boundI.attr("disabled","disabled")}}]),t}(p)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalFileSource=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(3),i=n(0);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.LocalFileSource=function(e){function t(){return a(this,t),u(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"bindTemplate",value:function(e){var t=this;this.fileSelect=e,this.fileInput=this.fileSelect.find("input[type='file']"),this.fileInput.on("change",(function(){t.handle(t.fileInput[0].files[0])}))}},{key:"name",get:function(){return i.i18n.source_local_file}},{key:"template",get:function(){return'<div class="form-group file-select" data-placeholder="'+i.i18n.modal_drop_zone_text+'">\n                        <label> </label>\n                        <input type="file" class="form-control" accept=\'image/jpeg,image/png,image/gif,image/bmp,image/tiff\'>\n                    </div>'}}]),t}(o.Source)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RemoteFileSource=void 0;var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(3),a=n(0),u=n(8),s=(r=u)&&r.__esModule?r:{default:r};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}t.RemoteFileSource=function(e){function t(){return c(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"reset",value:function(){this.boundI.val("")}},{key:"bindTemplate",value:function(e){var t=this;this.bound=e,this.boundI=this.bound.find("input"),this.boundI.on("change",(function(){var e=s.default.API.setup.xhr();e.open("GET",t.boundI.val()),e.responseType="arraybuffer",e.onload=function(){if(200!==e.status)t.boundI.addClass("is_invalid");else{var n=new Blob([e.response],{type:e.getResponseHeader("content-type"),name:"test"});n.name=t.boundI.val().split("/").pop(),t.handle(n)}},e.onerror=function(){t.boundI.addClass("is_invalid")},e.send()})).on("input",(function(){t.boundI.removeClass("is_invalid")}))}},{key:"name",get:function(){return a.i18n.source_remote_file}},{key:"template",get:function(){return'<div class="input-group my-3">\n  <div class=\'input-group-prepend\'><span class="input-group-text">@</span></div> \n  <input type="text" class="form-control" placeholder="https://www.example.org/image.jpg">\n  <div class=\'input-group-append\'><button class=\'btn btn-outline-primary\' onclick=\'$(this).parent().parent().find("input").trigger("change")\'>'+a.i18n.source_remote_file_load+"</button></div></div>"}}]),t}(i.Source)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CameraSource=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(3),i=n(0);t.CameraSource=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.selectByDefault=!1,e.stream=null,e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"bindTemplate",value:function(e){var t=this;this.video=e.find("video"),this.error=e.find(".alert"),e.find("button").on("click",(function(){var e=document.createElement("canvas"),n=t.video[0];e.width=n.videoWidth,e.height=n.videoHeight,e.getContext("2d").drawImage(n,0,0,n.videoWidth,n.videoHeight),setTimeout((function(){for(var n=atob(e.toDataURL("image/png").split(",")[1]),r=n.length,o=new Uint8Array(r),a=0;a<r;a++)o[a]=n.charCodeAt(a);var u=new Blob([o],{type:"image/png"});u.name=i.i18n.source_camera_default_name,t.handle(u)}))}))}},{key:"presentError",value:function(e){console.log(e),this.error.show()}},{key:"initWebcam",value:function(e){console.log("OK",e),this.stream=e;var t=this.video[0];t.width=t.offsetWidth,t.height=t.offsetHeight,"srcObject"in t?t.srcObject=e:window.webkitURL?t.src=window.webkitURL.createObjectURL(e):window.URL&&(t.src=window.URL.createObjectURL(e)),t.play()}},{key:"select",value:function(){var e=this;this.error.hide();var t={video:!0};try{navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(t).then((function(t){return e.initWebcam(t)})).catch((function(t){return e.presentError(t)})):navigator.mediaDevices.webkitGetUserMedia?navigator.mediaDevices.webkitGetUserMedia(t).then((function(t){return e.initWebcam(t)})).catch((function(t){return e.presentError(t)})):navigator.mediaDevices.mozGetUserMedia?navigator.mediaDevices.mozGetUserMedia(t).then((function(t){return e.initWebcam(t)})).catch((function(t){return e.presentError(t)})):this.presentError()}catch(e){this.presentError(e)}}},{key:"deselect",value:function(){if(this.stream){console.log("DESEL");var e=this.video[0];e.pause(),e.src="",e.srcObject=void 0,this.stream.getTracks().forEach((function(e){return e.stop()}))}}},{key:"name",get:function(){return i.i18n.source_camera}},{key:"template",get:function(){return"<div class='d-flex justify-content-center'><div class='d-inline-block position-relative mx-auto my-3'>\n    <video width='300' height='225'></video>\n    <button class=\"btn btn-sm btn-outline-danger\" style=\"position: absolute; bottom: 1em; left: 50%;\">"+i.i18n.source_camera_capture+"</button><div class='alert alert-danger'>"+i.i18n.source_camera_error+"</div>\n </div></div>"}}]),t}(o.Source)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EditorFrame=void 0;var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(6),a=n(32),u=n(9),s=n(7);t.EditorFrame=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.translation=[0,0],n.scaleFactor=1,n.mask=e,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"setMask",value:function(e){e instanceof u.Mask?(this.mask=e,this.bound.find(".image-editor").css("width",e.frameDimensions[0]+"px").css("height",e.frameDimensions[1]+"px"),this.backdrop[0].style.background='url("data:image/svg+xml;utf8,<svg xmlns=\\"http://www.w3.org/2000/svg\\" viewBox=\\"0 0 '+e.frameDimensions[0]+" "+e.frameDimensions[1]+'\\"><path d=\\"'+e.maskSVG+'\\"></path></svg>"'):this.setMask(new s.MaskDefault)}},{key:"reset",value:function(){this.translation=[0,0],this.scaleFactor=1,this.boundImage.css("top",0).css("left",0).css("transform","scale(1)")}},{key:"bindTemplate",value:function(e){var n=this;(function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0})(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"bindTemplate",this).call(this,e),this.bound=e,this.canvas=e.find(".canvas"),this.backdrop=e.find(".backdrop"),this.setMask(this.mask),this.scaleEl=e.find("input[type='range']"),this.scaleEl.on("input",(function(){return n.scale()})),this.drag=new a.Drag(this.canvas[0],(function(e){return n.translate(e)}),null,(function(e){return n.dragComplete(e)}))}},{key:"scale",value:function(){var e=.02*this.scaleEl.val();e*=e,this.scaleFactor=e,this.boundImage.css("transform","scale("+e+")")}},{key:"translate",value:function(e){var t=e.dx,n=e.dy,o=r(this.translation,2),i=o[0],a=o[1];this.boundImage.css("top",a+n+"px").css("left",i+t+"px")}},{key:"dragComplete",value:function(e){var t=e.dx,n=e.dy,o=r(this.translation,2),i=o[0],a=o[1];this.translation=[i+t,a+n]}},{key:"saveProperties",value:function(e){e.translation=this.translation,e.scale=this.scaleFactor,e.frame=this.mask.imageDimensions,this.mask.saveProperties(e)}},{key:"template",get:function(){return'<div class=\'d-flex justify-content-center position-relative mb-3\'><div class="image-editor border border-primary rounded">\n                                <div class="canvas">\n                                    <img src="" alt=\'\'>\n                                    <div class="backdrop">&nbsp;</div>\n                                </div>\n                                <div class="im-tools w-100 d-flex justify-content-center">\n                                    <div class="slidecontainer">\n                                        <label for="image-editor-scale-range" class="sr-only"></label>\n                                        <input type="range" min="1" max="100" value="50" class="slider" id="image-editor-scale-range">\n                                    </div>\n                                </div>\n                            </div></div>'}}]),t}(i.Frame)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();var o=function(e,t){return window.addEventListener(e,t),function(){window.removeEventListener(e,t)}};t.Drag=function(){function e(t,n,r,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.pointerStart=null,this.el=t,this.ontranslate=n,this.onstart=r,this.ondrag=i,this.el.style.touchAction="none",this.el.addEventListener("pointerdown",this.down.bind(this));var a=o("pointermove",this.move.bind(this)),u=o("pointerup",this.up.bind(this));this.destroy=function(){a(),u()}}return r(e,[{key:"down",value:function(e){e.stopPropagation(),this.pointerStart=[e.pageX,e.pageY],"function"==typeof this.onstart&&this.onstart(e)}},{key:"move",value:function(e){if(this.pointerStart&&"function"==typeof this.ontranslate){e.preventDefault();var t=[e.pageX,e.pageY],n=t[1],r=[t[0]-this.pointerStart[0],n-this.pointerStart[1]],o=this.el.getBoundingClientRect().width/this.el.offsetWidth;this.ontranslate({dx:r[0]/o,dy:r[1]/o,e:e})}}},{key:"up",value:function(e){if(this.pointerStart){if("function"==typeof this.ondrag){var t=[e.pageX,e.pageY],n=t[1],r=[t[0]-this.pointerStart[0],n-this.pointerStart[1]],o=this.el.getBoundingClientRect().width/this.el.offsetWidth;this.ondrag({dx:r[0]/o,dy:r[1]/o,e:e})}this.pointerStart=null}}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MaskCircle=void 0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(7);t.MaskCircle=function(e){function t(e){var n=e.size,r=void 0===n?200:n,o=e.grid,i=void 0===o?10:o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{size:r}));return a.grid=i,a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),r(t,[{key:"maskSVG",get:function(){var e=[this.size,this.size/2,this.size/2-this.grid,2*(this.size/2-this.grid)],t=e[0],n=e[1],r=e[2],o=e[3];return"M 0,0 l"+t+",0 l 0, "+n+" l -"+this.grid+", 0 a "+r+","+r+" 0 1, 0 -"+o+", 0 a "+r+","+r+" 0 1, 0 "+o+", 0 l"+this.grid+",0 l 0,"+n+" l-"+t+",0z"}}]),t}(o.MaskDefault)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Mask4_3=void 0;var r=n(15);t.Mask4_3=function(e){function t(e){var n=e.width,r=void 0===n?1024:n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{width:r}));return o.q=3/4,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),t}(r.Mask16_9)}])}));